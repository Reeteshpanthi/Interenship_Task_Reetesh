

1-
# Retrieve the names and locations of restaurants with a rating of 4.5 or higher.
SELECT name,city,rating FROM restaurants
WHERE rating>=4.5;

2-
# Find the total number of orders placed by each customer

SELECT 
    c.CustomerID, 
    c.FirstName, 
    c.LastName, 
    COUNT(o.OrderID) AS TotalOrders
FROM 
    Customers c
LEFT JOIN 
    Orders o ON c.CustomerID = o.CustomerID
GROUP BY 
    c.CustomerID;

3-
 # List all restaurants offering "Italian" cuisine in "Mumbai".
 
 SELECT RestaurantID,name,city,CuisineType
 FROM restaurants
 WHERE City='Mumbai' and CuisineType='indian';

4-
 # Calculate the total revenue generated by each restaurant from completed orders.
 
SELECT r.Name AS RestaurantName,
SUM(o.OrderAmount) AS TotalRevenue
FROM Restaurants r
JOIN Orders o ON r.RestaurantID = o.RestaurantID
WHERE o.OrderStatus = 'Delivered'
GROUP BY r.RestaurantID;

5-
# Retrieve the most recent order placed by each customer.

SELECT o.OrderID,o.CustomerID,o.RestaurantID,o.OrderDate,o.OrderAmount,o.OrderStatus
FROM Orders o
WHERE o.OrderDate = (SELECT MAX(OrderDate)
FROM Orders
WHERE CustomerID = o.CustomerID);


6-
SELECT c.CustomerID,c.FirstName,c.LastName,c.Phone,c.City,c.JoinDate
FROM Customers c
LEFT JOIN Orders o
ON c.CustomerID = o.CustomerID
WHERE o.OrderID IS NULL;


7-
# Identify the most reviewed restaurants.

SELECT rv.Comment,r.Name AS RestaurantName,
COUNT(rv.ReviewID) AS ReviewCount
FROM Restaurants r
JOIN Reviews rv ON r.RestaurantID = rv.RestaurantID
GROUP BY r.RestaurantID
ORDER BY ReviewCount DESC;

	
8. Find the most preferred payment method.

SELECT PaymentMethod,COUNT(PaymentMethod) Most_Preferred
FROM payments 
GROUP BY PaymentMethod 
ORDER BY COUNT(PaymentMethod)
 DESC LIMIT 1

9. List the top 5 restaurants by total revenue.

SELECT r.RestaurantID,r.Name,r.City,sum(p.Amount) total_revenue 
FROM payments p 
INNER JOIN orders o 
ON p.OrderID=o.OrderID 
INNER JOIN restaurants r 
ON r.RestaurantID=o.RestaurantID
GROUP BY o.RestaurantID
ORDER BY total_revenue DESC LIMIT 5

10. Show the details of all cancelled orders along with the customer's and restaurant's names
		
SELECT r.RestaurantID,r.Name Restaurant_Name ,c.FirstName,c.LastName,o.OrderStatus
FROM restaurants r 
INNER JOIN orders o 
ON r.RestaurantID=o.RestaurantID 
INNER JOIN customers c 
ON c.CustomerID=o.CustomerID 
WHERE o.OrderStatus="Cancelled"
